{% load roles %}
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Dlapp CRM</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="{% url 'dashboard' %}">Dlapp</a>
    <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#nav"></button>
    <div id="nav" class="collapse navbar-collapse">
      <ul class="navbar-nav me-auto">

        {% if request.user|in_group:"Receptionist" or request.user|in_group:"OperationsManager" or request.user|in_group:"Doctor" %}        
          <li class="nav-item"><a class="nav-link" href="{% url 'patient_list' %}">Patients</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url 'appointment_list' %}">Appointments</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url 'bill_list' %}">Billing</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url 'expense_list' %}">Expenses</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url 'finance_report' %}">Reports</a></li>
        {% endif %}

        {% if request.user|in_group:"CRO" or request.user|in_group:"OperationsManager" %}
          <li class="nav-item"><a class="nav-link" href="{% url 'lead_list' %}">Leads</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url 'appointment_list' %}">Appointments</a></li>
        {% endif %}

        {% if request.user|in_group:"PharmacyManager" or request.user|in_group:"OperationsManager" %}
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">Pharmacy</a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="{% url 'pharmacy_medicine_list' %}">Medicines</a></li>
              <li><a class="dropdown-item" href="{% url 'pharmacy_stock_list' %}">Stock</a></li>
              <li><a class="dropdown-item" href="{% url 'pharmacy_tx_list' %}">Transactions</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="{% url 'pharmacy_sale_create' %}">New Sale</a></li>
            </ul>
        </li>
        {% endif %}
        
       

      </ul>
      <ul class="navbar-nav">
        {% if request.user.is_authenticated %}
        <li class="nav-item"><span class="navbar-text me-2">{{ request.user.username }}</span></li>
        <li class="nav-item">
            <form action="{% url 'logout' %}" method="post" class="d-inline">
            {% csrf_token %}
            <button class="btn btn-outline-light btn-sm" type="submit">Logout</button>
            </form>
        </li>
        {% else %}
        <li class="nav-item"><a class="btn btn-outline-light btn-sm" href="{% url 'login' %}">Login</a></li>
        {% endif %}

      </ul>
    </div>
  </div>
</nav>
<main class="container py-4">
  {% for m in messages %}<div class="alert alert-info">{{ m }}</div>{% endfor %}
  {% block content %}{% endblock %}
</main>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
